(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(n){if(n.ep)return;n.ep=!0;const e=o(n);fetch(n.href,e)}})();const m=document.querySelector(".burger"),y=document.querySelector(".burger__line"),p=document.querySelector(".nav"),g=document.querySelector("body"),v=document.querySelectorAll(".nav__item"),b=()=>{m.addEventListener("click",()=>{y.classList.toggle("line--hide"),m.classList.toggle("burger--transform"),p.classList.toggle("nav--hide"),g.classList.toggle("no-scroll")})},L=()=>{v.forEach(t=>{t.addEventListener("click",()=>{y.classList.remove("line--hide"),m.classList.remove("burger--transform"),p.classList.remove("nav--hide"),g.classList.remove("no-scroll")})})},u=document.querySelector(".list ul");window.addEventListener("DOMContentLoaded",async()=>{try{const t=await a();l(t)}catch(t){console.error("Ошибка загрузки данных:",t)}});const a=async()=>{const t=await fetch("http://localhost:3000/games");if(!t.ok)throw new Error(`HTTP error! ${t.status}`);return await t.json()},l=t=>{if(!u){console.error("Элемент .list ul не найден!");return}u.innerHTML="",t.forEach(r=>{u.insertAdjacentHTML("beforeend",`
		<li>${r.title}
			<div class="edit-inner">
				<button class="edit-btn action-btn btn--reset" data-id=${r.id}>✎</button>
				<button class="delete-btn action-btn btn--reset" data-id=${r.id}>&#10006</button>
			</div>
		</li>
		`)})},w=document.querySelector(".list ul"),E=async()=>{w.addEventListener("click",async t=>{if(t.target.classList.contains("delete-btn")){const r=t.target.dataset.id;try{if(confirm("Видалити гру?")){await S(r);const o=await a();l(o)}}catch(o){console.error("Ошибка удаления:",o)}}})},S=async t=>{const r=await fetch(`http://localhost:3000/games/${t}`,{method:"DELETE"});if(!r.ok)throw new Error(`HTTP error! ${r.status}`)},T=document.querySelector("form button"),f=document.querySelector("form input");T.addEventListener("click",async t=>{if(t.preventDefault(),!f.value.trim()){alert("Введите название игры");return}try{await q();const r=await a();l(r),f.value=""}catch(r){console.error("Ошибка:",r),alert("Не удалось добавить игру")}});const q=async()=>{const t=await fetch("http://localhost:3000/games",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:f.value.trim()})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`)},D=document.querySelector(".list ul");D.addEventListener("click",async t=>{if(t.target.classList.contains("edit-btn")){const r=t.target,o=r.closest("li"),i=r.dataset.id,n=o.querySelector(".game-title")||o.firstChild,e=document.createElement("input");e.type="text",e.classList.add("edit-input"),e.value=n.textContent.trim(),n.replaceWith(e),e.focus();const s=async()=>{e.removeEventListener("blur",s),e.removeEventListener("keydown",h);const c=e.value.trim();if(c&&c!==n.textContent.trim())try{await O(i,c);const d=await a();l(d)}catch(d){console.error("Ошибка:",d),e.replaceWith(n),alert("Ошибка обновления!")}else e.replaceWith(n)},h=c=>{c.key==="Enter"&&(c.preventDefault(),s()),c.key==="Escape"&&e.replaceWith(n)};e.addEventListener("blur",s),e.addEventListener("keydown",h)}});const O=async(t,r)=>{const o=await fetch(`http://localhost:3000/games/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r})});if(!o.ok)throw new Error(`HTTP error! ${o.status}`);return await o.json()},P=document.querySelector(".random-btn"),$=document.querySelector("header h1"),k=()=>{P.addEventListener("click",async()=>{try{const t=await a();if(!(t!=null&&t.length))throw new Error("Игры не найдены");const r=Math.floor(Math.random()*t.length);console.log(r);const o=t[r];return $.textContent=o.title,o}catch(t){return console.error("Ошибка при выборе игры:",t.message),null}})};k();E();b();L();
